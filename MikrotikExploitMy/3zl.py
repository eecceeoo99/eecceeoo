#!/bin/python
import sys,os
import optparse
import ipcalc

parser = optparse.OptionParser()
parser.add_option('-s', '--speed',action="store", dest="speed",help="enter speed", default="3000")
parser.add_option('-p', '--port',action="store", dest="port",help="enter deffrent port number", default="8291")
inputSw, args = parser.parse_args()

targets = args[0]
port = inputSw.port
speed = inputSw.speed

os.system("masscan " + targets + " -p"+port+" --rate="+speed+" -oX masscan-log.txt --exclude 255.255.255.255")

file = open("masscan-log.txt" , 'r')
new = open("ip-gost.txt", 'w')
i = 0
for s in file:
    find = s.find('addr="')
    theend = s.find('" addrtype=')
    if find > 0 :
        i = i+1
        print ( "%s=" + s[find+6:theend] ) %i
        new.write((s[find+6:theend]) + "\n")


new.close()
file.close()
